(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{50068:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clusters/details",function(){return t(92211)}])},92211:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return $}});var r=t(85893),i=t(59734),n=t(39618),l=t(11163),a=t(2504),d=t(80050),o=t(61279),c=t(30120),u=t(63029),x=t(48926),h=t(98376),p=t(9324);let f=[{accessorKey:"address",header:"Address"},{accessorKey:"status",header:"Status",sortable:!0},{accessorKey:"withdrawalAddress",header:"Withdrawal Address"},{accessorKey:"feeRecipient",header:"Fee Recipient"}],j=e=>{let{validators:s,currentAccount:t}=e,i=(0,u.Z)(s.flatMap(e=>[e.withdrawalAddress,e.feeRecipient])),l=e=>{let{address:s,index:t}=e;return(0,r.jsxs)(n.xv,{size:"4",color:"obolGreen",css:{display:"flex",alignItems:"center",justifyContent:"start",gap:"xxxs"},children:[(0,r.jsxs)(n.kC,{direction:"column",css:{mr:"$xxs",fontWeight:"$bold"},children:[i[t]&&(0,r.jsxs)(r.Fragment,{children:[i[t],(0,r.jsx)("br",{})]}),(0,r.jsx)(n.dh,{css:{fontWeight:"bold",color:"$obolGreen",width:"120px !important"},value:(0,o.zN)(s,[0,6],5),readOnly:!0})]}),(0,r.jsx)(x.Z,{address:s})]})},a=e=>{let{address:s,index:t}=e;return i[t]?(0,r.jsxs)(r.Fragment,{children:[i[t],(0,r.jsx)("br",{}),(0,r.jsxs)(n.xu,{css:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)(n.dh,{value:s,readOnly:!0,css:{mr:"$xxs",color:"$obolGreen",width:"120px !important"}}),(0,r.jsx)(x.Z,{address:s})]})]}):(0,r.jsxs)(n.xu,{css:{display:"flex",alignItems:"center",justifyContent:"start"},children:[(0,r.jsx)(n.dh,{value:(0,o.zN)(s,[0,6],5),readOnly:!0,css:{mr:"$xxs",color:"$obolGreen",width:"120px !important"}}),(0,r.jsx)(x.Z,{address:s})]})};return(0,r.jsx)(n.Nk,{tabs:[{title:"Validators",tableProps:{columns:f,rows:s.map((e,s)=>({address:(0,r.jsxs)(n.xu,{css:{display:"flex",alignItems:"center",justifyContent:"start"},children:[(0,r.jsx)(n.dh,{value:(0,o.zN)(e.address,[0,6],5),readOnly:!0,css:{mr:"$xxs",color:"$obolGreen",width:"120px !important"}}),(0,r.jsx)(h.j,{link:"".concat(p.q2,"/validator/").concat(e.address)})]}),status:e.status||"Pending",withdrawalAddress:(0,o.qF)(t,e.withdrawalAddress)?(0,r.jsx)(l,{address:e.withdrawalAddress,index:s}):(0,r.jsx)(a,{address:e.withdrawalAddress,index:s}),feeRecipient:(0,o.qF)(t,e.feeRecipient)?(0,r.jsx)(l,{address:e.feeRecipient,index:s+1}):(0,r.jsx)(a,{address:e.feeRecipient,index:s+1})}))}}]})},v=(0,n.zo)(n.kC,{flexDirection:"column",width:"auto",gap:"$2xl",px:"10%",py:"$5xl","@sm":{px:"10%",py:"$5xl"}});var m=t(71866);t(67294);var g=t(19485);let w=e=>{let{heading:s,linkTitle:t,link:i}=e;return(0,r.jsxs)(n.mh,{children:[(0,r.jsx)(n.xu,{children:(0,r.jsx)(n.nQ,{})}),(0,r.jsxs)(n.xu,{css:{display:"flex",fd:"column",gap:"$sm"},children:[(0,r.jsx)(n.xu,{css:{display:"flex",fd:"column",gap:"$xs"},children:(0,r.jsx)(n.xv,{variant:"body",css:{color:"white"},children:s})}),i&&(0,r.jsxs)(n.rU,{css:{fontSize:"$4",fontWeight:"$normal"},target:"_blank",href:i,children:[t,(0,r.jsx)(n._j,{size:"sm"})]})]})]})},y=e=>{let{splitBalance:s,distribute:t,feeRecipientAddress:i,splitMetadata:l,handleOnDistributeETH:d}=e,{account:o}=(0,a.kR)(),c=(null==t?void 0:t.loading)?{variant:"tx"}:{},u=(null==t?void 0:t.loading)?{variant:"tx"}:{};return(0,r.jsxs)(n.kC,{css:{gap:"$lg","@sm":{flexDirection:"column",gap:"$md",alignItems:"flex-start",justifyContent:"flex-start",gridColumn:"span 2"}},children:[(0,r.jsxs)(n.W2,{css:{gap:"$lg",alignItems:"flex-start",justifyContent:"flex-start",gridColumn:"span 1"},children:[(0,r.jsx)(n.kC,{css:{justifyContent:"space-between",alignItems:"center"},children:(0,r.jsx)(n.xv,{variant:"h4",children:"Exit Cluster"})}),(null==t?void 0:t.completed)?(0,r.jsx)(w,{heading:"ETH successfully distributed",linkTitle:"View on Etherscan",link:"https://".concat(p.pn,".etherscan.io/tx/").concat(null==t?void 0:t.txHash)}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.xv,{variant:"body",children:"Exit all validators in this cluster."}),(0,r.jsx)(n.xv,{variant:"body",children:"This cluster will no longer earn rewards."}),(0,r.jsx)(n.xv,{variant:"body",children:"Upon exiting the cluster you will be able to withdraw the original principle & claim all rewards."}),(0,r.jsx)(m.fl,{...c,color:"primary",type:"button",css:{width:"auto"},disabled:!(0,g.isAddress)(i)||"0"===s||!(null==l?void 0:l.recipients.some(e=>"0x0000000"===e.address.toLowerCase())),onClick:()=>d(),children:(null==t?void 0:t.loading)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.yC,{}),"Transaction in progress"]}):(0,r.jsx)(r.Fragment,{children:"Exit Cluster"})})]})]}),(0,r.jsxs)(n.W2,{css:{gap:"$lg",alignItems:"flex-start",justifyContent:"flex-start",gridColumn:"span 1"},children:[(0,r.jsx)(n.kC,{css:{justifyContent:"space-between",alignItems:"center"},children:(0,r.jsx)(n.xv,{variant:"h4",children:"Claim ETH"})}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(m.fl,{...u,color:"primary",type:"button",css:{width:"auto"},disabled:!(0,g.isAddress)(o)||!(null==l?void 0:l.recipients.some(e=>e.address.toLowerCase()===(null==o?void 0:o.toLowerCase()))),onClick:()=>null,fullWidth:!0,children:"Claim ETH"})})]})]})},b=e=>{let{clusterDefinition:s,validators:t,currentAccount:i,clusterStatus:l}=e;return(0,r.jsxs)(v,{children:[(0,r.jsxs)(n.kC,{direction:"column",css:{gap:"$xxs"},children:[(0,r.jsx)(n.xv,{variant:"h3",children:null==s?void 0:s.name}),(0,r.jsx)(n.xv,{variant:"metadata",color:"body",children:"Created ".concat(c.ou.fromISO(null==s?void 0:s.timestamp).toRelativeCalendar()," on ").concat(c.ou.fromISO(null==s?void 0:s.timestamp).toFormat("yyyy LLL dd"))})]}),(0,r.jsxs)(n.kC,{css:{gap:"$lg","@sm":{flexDirection:"column"}},children:[(0,r.jsx)(n.gK,{heading:"Cluster Status",status:l,tooltipContent:"The cluster aggregate status"}),(0,r.jsx)(n.gK,{heading:"Operators",content:s.operators.length||"N/A",tooltipContent:"The number of cluster operators"}),(0,r.jsx)(n.gK,{heading:"Validators",content:(null==t?void 0:t.length)||"N/A",tooltipContent:"The number of cluster validators"})]}),(0,r.jsx)(m.Dq,{operators:s.operators,currentAccount:i,creatorAddress:s.creator.address}),t&&(null==t?void 0:t.length)>0?(0,r.jsx)(j,{validators:t.map((e,s)=>({id:s.toString(),...e}))}):(0,r.jsxs)(n.W2,{css:{gap:"$lg",alignItems:"flex-start"},children:[(0,r.jsx)(n.sQ,{heading:"Distributed Key Generation is incomplete"}),(0,r.jsx)(n.zx,{as:"a",href:"/dv?configHash=".concat(s.config_hash),target:"_blank",children:"Complete DKG"})]}),(null==t?void 0:t.length)>0&&(0,r.jsx)(y,{feeRecipientAddress:s.fee_recipient_address,handleOnDistributeETH:()=>null,splitBalance:"-",distribute:{completed:!1,loading:!1},splitMetadata:{recipients:[{address:"0x12312423423423"}]}})]})},C=e=>{let{children:s}=e;return(0,r.jsxs)(n.W2,{css:{borderRadius:0,marginTop:"$7xl"},children:[(0,r.jsx)(n.xv,{variant:"h4",children:"Error \uD83D\uDE25"}),(0,r.jsx)(n.xv,{variant:"body",children:s})]})},_=async e=>{if(e.includes("/lock/"))return(0,d.kS)(e);if(e.includes("/dv/"))return(0,d.FU)(e);throw Error("Invalid URL format")},k=()=>{var e,s,t,d;let c=(0,l.useRouter)(),{account:u}=(0,a.kR)(),x=c.query.lockHash,{data:h,error:p,isLoading:f}=(0,i.ZP)(x?"/lock/".concat(x):null,_);if(x&&!h&&!f)return(0,r.jsx)(C,{children:(null==p?void 0:null===(e=p.response)||void 0===e?void 0:null===(s=e.data)||void 0===s?void 0:s.message)||"Error: No details information provided, please double check the\n            link you followed or return to the home page."});if(p&&!h)return(0,r.jsx)(C,{children:null==p?void 0:null===(t=p.response)||void 0===t?void 0:null===(d=t.data)||void 0===d?void 0:d.message});if(!h||f)return(0,r.jsxs)(v,{children:[(0,r.jsx)(n.xv,{variant:"subline",children:"Loading cluster data..."}),";"]});let j=h;if(x){let e=null==h?void 0:h.distributed_validators.map((e,s)=>({status:(0,r.jsx)(n.HV,{status:e.status,textVariant:"metricStatusCell"}),address:e.distributed_public_key,withdrawalAddress:(null==h?void 0:h.cluster_definition.validators)?null==h?void 0:h.cluster_definition.validators[s].withdrawal_address:null==h?void 0:h.cluster_definition.withdrawal_address,feeRecipient:(null==h?void 0:h.cluster_definition.validators)?null==h?void 0:h.cluster_definition.validators[s].fee_recipient_address:null==h?void 0:h.cluster_definition.fee_recipient_address}));j={clusterDefinition:h.cluster_definition,validators:e,currentAccount:u,clusterStatus:(0,o.Uq)(h)}}else j={clusterDefinition:h,currentAccount:u,clusterStatus:(0,o.yc)(h)};return(0,r.jsx)(b,{...j})};var $=k}},function(e){e.O(0,[120,774,888,179],function(){return e(e.s=50068)}),_N_E=e.O()}]);